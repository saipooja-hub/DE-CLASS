--Assignment Questions:

*Get all customers whose first name starts with 'J' and who are active.

select * from sakila.customer;

select first_name,active from sakila.customer where first_name LIKE 'J%' and Active = 1 ;

*Find all films where the title contains the word 'ACTION' or the description contains 'WAR'.

select * from sakila.film;

select * from sakila.film 
where title LIKE '%ACTION%' OR description LIKE '%WAR%';

*List all customers whose last name is not 'SMITH' and whose first name ends with 'a'.

select * from sakila.customer;

select last_name,first_name from sakila.customer 
where last_name NOT LIKE 'SMITH' and first_name LIKE '%A';

*Get all films where the rental rate is greater than 3.0 and the replacement cost is not null.

select * from sakila.film;

select rental_rate,replacement_cost from sakila.film 
where rental_rate > 3.0 and replacement_cost IS NOT NULL;

*Count how many customers exist in each store who have active status = 1.

select store_id,count(*) AS active_customers 
from sakila.customer 
where active = 1
group by store_id;

*Show distinct film ratings available in the film table.

select * from sakila.film;

select distinct rating from sakila.film;

*Find the number of films for each rental duration where the average length is more than 100 minutes.

select rental_duration,AVG(length) as AVG_length,count(*) AS number_of_film
from sakila.film 
group by rental_duration
HAVING AVG(length) > 100; 

*List payment dates and total amount paid per date, but only include days where more than 100 payments were made.

select * from sakila.payment;

select payment_date,SUM(amount) AS total_amount_paid_per_date 
from sakila.payment
group by payment_date
HAVING COUNT(*) > 100;

*Find customers whose email address is null or ends with '.org'.

select * from sakila.customer;

select email 
from sakila.customer 
where email IS NULL 
OR email LIKE '%.org'

*List all films with rating 'PG' or 'G', and order them by rental rate in descending order.

select * from sakila.film;
select rating,rental_rate from sakila.film 
where rating ='PG' OR rating ='G' 
ORDER BY rental_rate DESC;

*Count how many films exist for each length where the film title starts with 'T' and the count is more than 5.

SELECT length, COUNT(*) AS num_films
FROM sakila.film
WHERE title LIKE 'T%'
GROUP BY length
HAVING COUNT(*) > 5;

*List all actors who have appeared in more than 10 films.

select * from sakila.actor;

*Find the top 5 films with the highest rental rates and longest lengths combined, ordering by rental rate first and length second.

select * from sakila.film;

SELECT title, rental_rate, length
FROM sakila.film
ORDER BY rental_rate DESC, length DESC
LIMIT 5;





